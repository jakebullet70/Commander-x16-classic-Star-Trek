## --------------------------------------------------------------------
## BASLOAD ISO CRLF 
## Dad TESTING STUFF
## Dad TESTING STUFF
## Dad TESTING STUFF
## --------------------------------------------------------------------
#CONTROLCODES 1
#SYMFILE "@:TEST1.SYM"
## #SAVEAS "@:TEST1.PRG"

START:
	POKE $030C,4 : SYS $FF62 : REM --- CHANGE TO THIN PET UPPER/GRAPHICS
	GOSUB INIT_COLORS
	SCREEN $80
	CLS 
	
	DEBUG = -1

	GOSUB DETECT_IF_JOYSTICK


MMU_SHOW:
	IF MMU_INIT = 0 THEN GOSUB INIT_SCROLL_MENU : CM=1 : MMU_SELECTED_NDX=0 : MMU_INIT = 1
	GOSUB MMU_UPDATE_SCRN
	IF RET = 1 THEN LOCATE 1,28 : PRINT "M1" 
	IF RET = 2 THEN LOCATE 1,28 : PRINT "M2" 
	IF RET = 3 THEN LOCATE 1,28 : PRINT "QUIT" : END 
	GOTO MMU_SHOW
	

MMU_UPDATE_SCRN:
	REM ===== DISPLAY OPTIONS =====
		
	COLOR CLR_TXT_NORMAL
	FOR N = 1 TO MENUS.TTL
		FOR M = 1 TO MENUS.SUB.ITEMS.TTL(N)
			LOCATE MNU.Y.LOCATION(N,M)+1,MNU.X.LOCATION(N,M)+1: PRINT MNU.TEXT$(N,M) 
		NEXT M
	NEXT N
		
	SLEEP 10 : GOSUB KB_BUFFER_CLEAR
	IF MMU_SELECTED_NDX<>0 THEN GOTO LINE10145MNU
	MMU_SELECTED_NDX=1
	
LINE10130MNU:
	IF MMU_SELECTED_NDX <= MENUS.SUB.ITEMS.TTL(CM) THEN MMU_SELECTED_NDX=MMU_SELECTED_NDX+1:GOTO LINE10130MNU
	REM IF MNU.DEFAULT(CM,MMU_SELECTED_NDX)=0 AND MMU_SELECTED_NDX<=MENUS.SUB.ITEMS.TTL(CM) THEN MMU_SELECTED_NDX=MMU_SELECTED_NDX+1:GOTO LINE10130MNU
	IF MMU_SELECTED_NDX > MENUS.SUB.ITEMS.TTL(CM) THEN MMU_SELECTED_NDX=1
	
LINE10145MNU:
	COLOR CLR_TXT_BRIGHT
	LOCATE MNU.Y.LOCATION(CM,MMU_SELECTED_NDX)+1,MNU.X.LOCATION(CM,MMU_SELECTED_NDX)+1 : PRINT CHR$($12) + MNU.TEXT$(CM,MMU_SELECTED_NDX)

WAITKEY01MNU:
	GOSUB KB_JOY_KEYS_GET : SLEEP 6
	REM CHAR 0,6,CLR_TXT_NORM,CHR$($12) + KB.STR$
	REM LOCATE 1,6 : PRINT KB_STR$
	IF KB_STR$ = "F" THEN RET = MNU.RET.VAL(CM,MMU_SELECTED_NDX) : RETURN
	IF KB_STR$ = "L" THEN MMU_SELECTED_NDX=MMU_SELECTED_NDX-1 	: IF MMU_SELECTED_NDX=0 THEN MMU_SELECTED_NDX = MENUS.SUB.ITEMS.TTL(CM)
	IF KB_STR$ = "R" THEN MMU_SELECTED_NDX=MMU_SELECTED_NDX+1 	: IF MMU_SELECTED_NDX > MENUS.SUB.ITEMS.TTL(CM) THEN MMU_SELECTED_NDX=1
	rem IF KB_STR$ = "D" THEN MMU_SELECTED_NDX=0 		: CM=CM+1 : IF CM > MENUS.TTL THEN CM=1
	rem IF KB_STR$ = "U" THEN MMU_SELECTED_NDX=0 		: CM=CM-1 : IF CM = 0 THEN CM=MENUS.TTL
	GOTO MMU_UPDATE_SCRN

		
INIT_SCROLL_MENU:
	
	MENUS.TTL = 1
	DIM MNU.X.LOCATION(MENUS.TTL,3) : DIM MNU.Y.LOCATION(MENUS.TTL,3):
	DIM MNU.TEXT$(MENUS.TTL,3) ,MNU.RET.VAL(MENUS.TTL,3)
	REM DIM MNU.DEFAULT(MENUS.TTL,3) 

	REM --- SUB ITEMS TTL
	MENUS.SUB.ITEMS.TTL(1)=3
	
	REM : MENUS.SUB.ITEMS.TTL(2)=2 : MENUS.SUB.ITEMS.TTL(3)=2
	REM MENUS.SUB.ITEMS.TTL(4)=1   : MENUS.SUB.ITEMS.TTL(5)=1 
	
	MNU.X.LOCATION(1,1)=10 : MNU.Y.LOCATION(1,1)= 7 : MNU.TEXT$(1,1)=" EASY "				:MNU.RET.VAL(1,1) = 1
	MNU.X.LOCATION(1,2)=19 : MNU.Y.LOCATION(1,2)= 7 : MNU.TEXT$(1,2)=" MED "				:MNU.RET.VAL(1,2) = 2
	MNU.X.LOCATION(1,3)=28 : MNU.Y.LOCATION(1,3)= 7 : MNU.TEXT$(1,3)=" QUIT "				:MNU.RET.VAL(1,3) = 3
	REM MNU.DEFAULT(1,1)=1
		
	REM MNU.X.LOCATION(2,1)=15 : MNU.Y.LOCATION(2,1)=12 : MNU.TEXT$(2,1)=" ON "					:MNU.RET.VAL(2,1) = RET.VAL.SOUND.ON
	REM MNU.X.LOCATION(2,2)=20 : MNU.Y.LOCATION(2,2)=12 : MNU.TEXT$(2,2)=" OFF "				:MNU.RET.VAL(2,2) = RET.VAL.SOUND.OFF
	REM MNU.DEFAULT(2,OPTIONS.SOUND)=1
	RETURN


INIT_COLORS:

	CLR_TXT_NORMAL = 2	
	CLR_TXT_BRIGHT = 5
	CLR_TXT_HEADER = 9

	RETURN

	
	
## ----------------  INCLUDE FILES HERE ----
REM #INCLUDE "SW-MENU.BAS"
#INCLUDE "\INCLUDE_SRC\KEYS-MOUSE.BL" 



